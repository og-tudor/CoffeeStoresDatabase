{% extends "base.html" %}

{% block extra_styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/coffee_stores.css') }}">
{% endblock %}

{% block content %}
<div class="main-content">
    <div class="details_container">
        <div class="dropdown-container">
            <label for="coffee-store-select">Select Coffee Store:</label>
            <select id="coffee-store-select">
                <option value="" disabled selected>Choose a coffee store</option>
            </select>
    
            <label for="month-select">Select Month:</label>
            <select id="month-select">
                <option value="" disabled selected>Choose a month</option>
                <option value="1">January</option>
                <option value="2">February</option>
                <option value="3">March</option>
                <!-- Continuă pentru toate lunile -->
            </select>
    
            <label for="year-select">Select Year:</label>
            <select id="year-select">
                <option value="" disabled selected>Choose a year</option>
                <option value="2024">2024</option>
                <option value="2023">2023</option>
                <!-- Adaugă alte opțiuni de ani -->
            </select>
        </div>
    
        <div id="coffee-store-details" style="margin-top: 20px;">
            <!-- Detaliile cafenelei vor fi afișate aici -->
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        // Populează dropdown-ul cu cafenele
        $.get('/api/coffee_stores_list', function (data) {
            const dropdown = $('#coffee-store-select');
            data.forEach(item => {
                dropdown.append(`<option value="${item.id}">${item.name}</option>`);
            });
        });

        // Eveniment pentru selectarea cafenelei și a datei
        $('.dropdown-container select').change(function () {
            const storeId = $('#coffee-store-select').val();
            const month = $('#month-select').val();
            const year = $('#year-select').val();

            if (storeId && month && year) {
                $.get(`/api/coffee_store_details/${storeId}/${month}/${year}`, function (data) {
                    const detailsDiv = $('#coffee-store-details');
                    detailsDiv.empty();
                    detailsDiv.append(`
                        <h3>${data.name}</h3>
                        <p>City: ${data.city}</p>
                        <p>Revenue Goal: ${data.revenue_goal}</p>
                        <p>Manager: ${data.manager}</p>
                        <p>Top Product: ${data.top_product}</p>
                        <p>Total Revenue: ${data.total_revenue}</p>
                    `);
                }).fail(function () {
                    alert('Failed to load details.');
                });
            }
        });
    });
</script>


{% endblock %}
